# 突破黄金-EA【2023】 用户手册 (README)

## 概述

**突破黄金-EA【2023】** 是一款专为 MetaTrader 4 (MT4) 平台设计的自动化交易程序（Expert Advisor）。它基于一种经典的 **突破 (Breakout)** 策略，并集成了一套独特的 **亏损后熔断 (Circuit Breaker)** 机制，旨在提高交易的稳定性并控制风险。

该 EA 的核心逻辑是在当前市场价格的上下方设置挂单（Buy Stop 和 Sell Stop），以捕捉价格突破关键点位后的大幅波动。同时，它会持续地跟踪市场，动态调整挂单位置，并在订单成交后通过一套复杂的分阶段逻辑来管理移动止损。

## 核心策略

1.  **动态突破挂单**：EA 不会在一个固定的价格下挂单，而是根据当前市价加上一个可调的 `step`（挂单距离）来动态设置 Buy Stop 和 Sell Stop 订单。
2.  **挂单跟随**：当市场价格变动超过一定阈值后，EA 会自动修改（移动）未成交的挂单，使其始终与当前价格保持设定的距离，确保随时准备好捕捉突破。
3.  **多阶段移动止损**：订单成交后，EA 会启动一个复杂但有效的移动止损逻辑。它会根据订单的盈利情况，分阶段、分步长地收紧止损位，旨在保护浮动盈利。
4.  **亏损熔断机制**：这是此 EA 最具特色的功能。当一笔交易发生亏损后，EA 会自动暂停所有交易活动一段预设的时间（例如30分钟），以避免在不利的市场条件下或因情绪化决策而连续亏损。

## 主要功能

*   **全自动突破交易**：自动放置和管理突破挂单。
*   **智能手数管理**：支持固定手数或根据账户余额和风险等级自动计算手数。
*   **亏损后暂停（熔断机制）**：在交易失利后自动“冷静”一段时间，规避连续亏损风险。
*   **精细化移动止损**：内置多层逻辑，动态跟踪盈利。
*   **交易时间过滤**：可设定EA仅在每天的特定时间段内运行，避开不适合交易的时段。

---

## 参数详解 (Parameters Explained)

当您将 EA 加载到图表时，可以在“输入”选项卡中配置以下参数。

### `==== Setting ====` (主要设置)

*   `magicnumber` (魔术号)
    *   **默认值**: `333`
    *   **说明**: EA 的唯一标识码。用于区分由此 EA 管理的订单。请确保每个图表上的魔术号是唯一的。**注释中提到尽量为333，可能与熔断机制的逻辑有关，建议保持默认**。

*   `AutoLot` (自动手数)
    *   **默认值**: `true`
    *   **说明**: 是否开启自动手数计算功能。
        *   `true`: EA 将根据账户余额和下方 `AutoLotMode` 的风险设置来计算下单手数。
        *   `false`: EA 将使用 `FixLot` 参数设定的固定手数。

*   `AutoLotMode` (自动手数模式)
    *   **默认值**: `Moderate (20)`
    *   **说明**: 设定自动手数的风险等级。这是一个枚举选项，包含三种预设模式。
        *   **重要提示**: 该值在后台作为**除数**使用，因此**数值越小，风险越高，手数越大**。
        *   `Expert = 10`: **激进模式**。手数计算公式中的风险因子较小，导致下单手数相对较大。
        *   `Moderate = 20`: **稳健模式**。风险适中，是推荐的默认选项。
        *   `Safe = 30`: **保守模式**。风险因子较大，导致下单手数相对较小。

*   `FixLot` (固定手数)
    *   **默认值**: `0.01`
    *   **说明**: 当 `AutoLot` 设置为 `false` 时，EA 将使用此值作为固定的下单手数。

### `=== Leave as Default ====` (订单默认设置)

*   `stoploss` (止损)
    *   **默认值**: `200`
    *   **说明**: 初始止损距离，单位为点（Points）。例如，200点对于黄金（XAUUSD）通常意味着2美元的价差。

*   `takeprofit` (止盈)
    *   **默认值**: `1300`
    *   **说明**: 初始止盈距离，单位为点（Points）。

*   `step` (挂单距离)
    *   **默认值**: `200`
    *   **说明**: Buy Stop / Sell Stop 挂单距离当前市价的距离，单位为点（Points）。

### `==== Time Filter ====` (时间过滤器)

*   `StartHour` (开始小时)
    *   **默认值**: `1`
    *   **说明**: EA 开始交易的小时（基于服务器时间，0-23）。

*   `StopHour` (停止小时)
    *   **默认值**: `23`
    *   **说明**: EA 停止交易的小时。EA 将在 `StartHour` 和 `StopHour` 之间的时间段内运行。

### `==== Stop on Loss Setting ====` (亏损熔断设置)

这是本 EA 的核心风控功能。

*   `PauseOnLoss_Enabled` (开启亏损后暂停)
    *   **默认值**: `true`
    *   **说明**: 此功能的主开关。
        *   `true`: 开启熔断机制。当有订单亏损平仓后，EA会暂停交易。
        *   `false`: 关闭熔断机制。

*   `PauseDuration_Minutes` (暂停时间 - 分钟)
    *   **默认值**: `30`
    *   **说明**: 当亏损发生后，EA 需要暂停多长时间（单位：分钟）。

*   `DeletePendingsOnLoss` (亏损时删除挂单)
    *   **默认值**: `true`
    *   **说明**: 触发暂停时，是否要立即删除所有未成交的挂单。
        *   `true`: 立即删除所有挂单，彻底停止交易活动。
        *   `false`: 保留未成交的挂单，但不会再下新的挂单，直到暂停时间结束。

## 安装与使用

1.  **安装**:
    *   打开 MT4 平台。
    *   点击左上角 "文件" (File) -> "打开数据文件夹" (Open Data Folder)。
    *   进入 `MQL4` -> `Experts` 文件夹。
    *   将 `.mq4` 或 `.ex4` 文件复制到此文件夹中。
    *   返回 MT4，在左侧“导航器”窗口中的“EA交易”上右键点击，选择“刷新”。您应该能看到“突破黄金-EA【2023】”。

2.  **使用**:
    *   将 EA 从导航器窗口拖拽到您想运行的黄金（XAUUSD）图表上。
    *   在弹出的设置窗口中，确保 "允许实时自动交易" (Allow live trading) 已被勾选。
    *   切换到 "输入" (Inputs) 选项卡，根据您的风险偏好和策略调整上述参数。
    *   点击“确定”。
    *   确保 MT4 终端顶部的 "自动交易" (AutoTrading) 按钮是绿色开启状态。
    *   图表右上角会显示一个笑脸图标，表示 EA 正在正常运行。

## 重要提示

*   **风险警告**: 所有交易都存在风险。自动化交易系统并不能保证盈利。请在模拟账户上进行充分的测试，直到您完全理解其行为和风险。
*   **点差与滑点**: 突破策略对交易环境较为敏感。低点差和低滑点的经纪商环境更有利于此 EA 的表现。
*   **VPS 使用**: 为了确保 EA 能够 24/5 不间断运行，强烈建议将其部署在虚拟专用服务器（VPS）上。